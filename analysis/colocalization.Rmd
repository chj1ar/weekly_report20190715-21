---
title: "colocalization"
author: "chj1ar"
date: "2019-08-12"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

## Background

The main improvement of Enloc over Torus in enrichment analysis is that Enloc incorporates eQTL annotations by sampling d, the causal states of eQTL SNPs, from its posterior distribution, instead of directly using imprecise d's, as Torus does.

To be specific, the posterior distribution of d is derived from individual-level genotype-expression data. Then, there are dozens of annotations, i.e., d, sampled from the posterior distribution of d, and for each sampled annotation, enrichment analysis will be performed by Torus to generate their respective results of log odds ratio, 95% CI, etc.. The final result is generated by taking the average of the respective results of sampled annotations.

In theory, it can be shown that this scheme, the so-called 'multiple imputation', is way better than directly using eQTL PIPs, the posterior distributions of d's, i.e., the so-called 'mean imputation', which is still better than directly using imprecise d's, which Torus does exactly.

## Results

Before showing the results on SCZ, it'd be better to show the correctness of the pipeline by reproducing the Figure 5 of the Enloc paper. Specifically, we performed enrichment analysis of GTEx Whole Blood eQTLs data on 4 lipid traits, namely, high density lipoprotein (HDL), low density lipoprotein (LDL), triglycerides (TG), and total cholesterol (TC), and the following figure, Figure 1, shows the results.

```{r, echo=FALSE}
library(png)
lipid_traits <- readPNG(source = '~/Documents/留学/暑研/Xin/reading_materials/5th/lipid_traits_Enloc.png')
library(grid)
grid.raster(lipid_traits)
```

Figure 1: enrichment of GTEx Whole Blood eQTLs on 4 lipid traits, namely, HDL, LDL, TC, TG, by Enloc.

There is little difference from the Figure 5 of the Enloc paper, demonstrating that the pipeline should be correct.

The results for SCZ will be shown after getting necessary data.
